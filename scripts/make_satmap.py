import matplotlib.pyplot as plt
import numpy as np
from environments.belief2d import Belief2D
# img = plt.imread("preliminary_results/figures/satmap.png")
img = plt.imread("preliminary_results/figures/hysplit_map.jpg")
fig, ax = plt.subplots()
xdim, ydim = (40, 20)
ax.imshow(img, extent=[0, xdim, 0, ydim])
bspace = Belief2D(xdim, ydim)
X,Y = np.meshgrid(np.arange(0,xdim,1), np.arange(0,ydim,1))
traj = np.array([
    (20.0, 17.5),
    (19.403992007614818, 17.3),
    (18.831744973074052, 17.1),
    (18.3060725798149, 16.900000000000002),
    (17.847931727301436, 16.700000000000003),
    (17.475587045576315, 16.500000000000004),
    (17.203882742098326, 16.300000000000004),
    (17.04365081003462, 16.100000000000005),
    (17.001279190875483, 15.900000000000006),
    (17.07845710736541, 15.700000000000006),
    (17.272107719522946, 15.500000000000007),
    (17.574510788541215, 15.300000000000008),
    (17.973610458346528, 15.100000000000009),
    (18.453495884535585, 14.90000000000001),
    (18.995035549532258, 14.70000000000001),
    (19.576639975820367, 14.50000000000001),
    (20.175122430282705, 14.300000000000011),
    (20.766623306080458, 14.100000000000012),
    (21.327561329884524, 13.900000000000013),
    (21.835573672828126, 13.700000000000014),
    (22.270407485923755, 13.500000000000014),
    (22.614727317240742, 13.300000000000015),
    (22.854806221668532, 13.100000000000016),
    (22.98107301090039, 12.900000000000016),
    (22.988493826507526, 12.700000000000017),
    (22.87677282398943, 12.500000000000018),
    (22.650363967160487, 12.300000000000018),
    (22.318293462668, 12.10000000000002),
    (21.89379991361701, 11.90000000000002),
    (21.393806538241325, 11.70000000000002),
    (20.838246494596838, 11.500000000000021),
    (20.249268208452555, 11.300000000000022),
    (19.65035238544859, 11.100000000000023),
    (19.06537590945993, 10.900000000000023),
    (18.51765994658424, 10.700000000000024),
    (18.02904020384369, 10.500000000000025),
    (17.61899640845259, 10.300000000000026),
    (17.303875712565155, 10.100000000000026),
    (17.09624098390556, 9.900000000000027),
    (17.00436996387619, 9.700000000000028),
    (17.031925260129842, 9.500000000000028),
    (17.17780832996065, 9.30000000000003),
    (17.43620327573511, 9.10000000000003),
    (17.796808706377597, 8.90000000000003),
    (18.245248421324636, 8.700000000000031),
    (18.763644544274644, 8.500000000000032),
    (19.331330257699165, 8.300000000000033),
    (19.925673723639825, 8.100000000000033),
    (20.522980343668838, 7.900000000000033),
    (21.099437387755692, 7.700000000000033),
    (21.63206333266803, 7.500000000000033),
    (22.09962406278056, 7.300000000000033),
    (22.483479407256905, 7.1000000000000325),
    (22.768326264838382, 6.900000000000032),
    (22.942808690199456, 6.700000000000032),
    (22.99997061965211, 6.500000000000032),
    (22.937533187453973, 6.300000000000032),
    (22.757985576994066, 6.100000000000032),
    (22.46848578490618, 5.900000000000031),
    (22.080575254331436, 5.700000000000031),
    (21.609718754001385, 5.500000000000031),
    (21.07468784671057, 5.300000000000031),
    (20.496812526345018, 5.100000000000031),
    (19.89913085833668, 4.9000000000000306),
    (19.305470524695476, 4.70000000000003),
    (18.73949888952016, 4.50000000000003),
    (18.2237794558784, 4.30000000000003),
    (17.778872330142715, 4.10000000000003),
    (17.42251455543056, 3.9000000000000297),
    (17.168912991667714, 3.7000000000000295),
    (17.0281779329154, 3.5000000000000293),
    (17.00592004185091, 3.300000000000029),
    (17.103026670352143, 3.100000000000029),
    (17.31562648357845, 2.9000000000000288),
    (17.635243797873997, 2.7000000000000286),
    (18.049136479528585, 2.5000000000000284),
    (18.540803933438525, 2.3000000000000282),
    (19.090644929762814, 2.100000000000028),
    (19.676739043101584, 1.900000000000028),
    (20.27572055068296, 1.7000000000000282),
    (20.863709949995116, 1.5000000000000282),
    (21.417265959195323, 1.3000000000000282),
    (21.914320047043777, 1.1000000000000283),
    (22.335056235602842, 0.9000000000000283),
    (22.662701100744474, 0.7000000000000284),
    (22.88419247563865, 0.5000000000000284),
    (22.99070019812478, 0.3000000000000284),
    (22.97797814141191, 0.1000000000000284),
])
ax.plot(traj.T[0], traj.T[1], c='red')
ax.quiver(X.T, Y.T,
          bspace.img[:, :, 0],
          bspace.img[:, :, 1],
          scale=10,
          color=(.1,.1,.1,.6))
plt.show()
